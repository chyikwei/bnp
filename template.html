

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Template &mdash; sklearn-template 0.1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/gallery.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="sklearn-template 0.1.0 documentation" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> sklearn-template
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="auto_examples/index.html">General examples</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">sklearn-template</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Template</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/template.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="template">
<h1>Template<a class="headerlink" href="#template" title="Permalink to this headline">¶</a></h1>
<p>The documentation of the template module.</p>
<span class="target" id="module-bnp.online_hdp"></span><p>Online HDP with variational inference</p>
<p>This implementation is modified from Chong Wang’s online-hdp code
(<a class="reference external" href="https://github.com/blei-lab/online-hdp">https://github.com/blei-lab/online-hdp</a>)</p>
<p>Also, some code are from scikit-learn’s online_lda implementation
and the code structure is the same.
(<a class="reference external" href="https://github.com/scikit-learn/scikit-learn/blob/master/sklearn/decomposition/online_lda.py">https://github.com/scikit-learn/scikit-learn/blob/master/sklearn/decomposition/online_lda.py</a>)</p>
<dl class="class">
<dt id="bnp.online_hdp.HierarchicalDirichletProcess">
<em class="property">class </em><code class="descclassname">bnp.online_hdp.</code><code class="descname">HierarchicalDirichletProcess</code><span class="sig-paren">(</span><em>n_topic_truncate=20</em>, <em>n_doc_truncate=10</em>, <em>omega=1.0</em>, <em>alpha=1.0</em>, <em>eta=0.01</em>, <em>learning_method='online'</em>, <em>kappa=0.5</em>, <em>tau=10.0</em>, <em>scale=1.0</em>, <em>max_iter=10</em>, <em>total_samples=1000000.0</em>, <em>batch_size=256</em>, <em>evaluate_every=0</em>, <em>perp_tol=0.1</em>, <em>mean_change_tol=0.001</em>, <em>max_doc_update_iter=100</em>, <em>check_doc_likelihood=False</em>, <em>n_jobs=1</em>, <em>burn_in_iters=3</em>, <em>verbose=0</em>, <em>random_state=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bnp/online_hdp.html#HierarchicalDirichletProcess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bnp.online_hdp.HierarchicalDirichletProcess" title="Permalink to this definition">¶</a></dt>
<dd><p>Hierarchical Dirichlet Process with Stochastic Variational Inference</p>
<p>HDP is the nonparametric version of LDA. The algorithm determines
the number of topics based on data it fits instead of using a fixed
number.</p>
<dl class="docutils">
<dt>Note: This implementation is described in Fig. 9 in [1]. A lot</dt>
<dd>of greek letter are used as variable names. Check Fig. 8
and Fig. 9 in [1] to know more about the alogrithm and each
variable. Some of notation are different from original
implementation in [3].</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>n_topic_truncate</strong> : int, optional (default=20)</p>
<blockquote>
<div><p>topics level truncation. In literature, it is <cite>K</cite></p>
</div></blockquote>
<p><strong>n_doc_truncate: int, optional (default=10)</strong></p>
<blockquote>
<div><p>document level truncation. In literature, it is <cite>T</cite></p>
</div></blockquote>
<p><strong>omega: float, optional (default=1.0)</strong></p>
<blockquote>
<div><p>topic level concentration</p>
</div></blockquote>
<p><strong>alpha: float, optional (default=1.0)</strong></p>
<blockquote>
<div><p>document level concentration</p>
</div></blockquote>
<p><strong>eta: float, optional (default=1e-2)</strong></p>
<blockquote>
<div><p>the topic Dirichlet prior</p>
</div></blockquote>
<p><strong>learning_method</strong> : ‘batch’ | ‘online’, default=’online’</p>
<blockquote>
<div><p>Method used to update latent variable. Only used in <cite>fit</cite> method.</p>
</div></blockquote>
<p><strong>kappa</strong> : float, optional (default=0.5)</p>
<blockquote>
<div><p>This is forgetting rate in the online learning
method. The value should be set between (0.5, 1.0] to guarantee
asymptotic convergence. When the value is 0.0 and batch_size is
<code class="docutils literal notranslate"><span class="pre">n_samples</span></code>, the update method is same as batch learning.</p>
</div></blockquote>
<p><strong>tau</strong> : float, optional (default=10.)</p>
<blockquote>
<div><p>A (positive) parameter that downweights early iterations in online
learning.  It should be greater than 1.0.</p>
</div></blockquote>
<p><strong>scale: float, optional (default=1.0)</strong></p>
<blockquote>
<div><p>scale for learning rate.</p>
</div></blockquote>
<p><strong>max_iter</strong> : int, optional (default=10)</p>
<blockquote>
<div><p>The maximum number of iterations.</p>
</div></blockquote>
<p><strong>total_samples: int, optional (default=1e6))</strong></p>
<blockquote>
<div><p>number of document. Only used in the <cite>partial_fit</cite> method.</p>
</div></blockquote>
<p><strong>batch_size</strong> : int, optional (default=256)</p>
<blockquote>
<div><p>MiniBatch size. Number of documents to use in each EM iteration.
Only used in online learning.</p>
</div></blockquote>
<p><strong>evaluate_every</strong> : int, optional (default=0)</p>
<blockquote>
<div><p>How often to evaluate ELOB. Only used in <cite>fit</cite> method.
set it to 0 or negative number to not evalute perplexity in
training at all. Evaluating perplexity can help you check convergence
in training process, but it will also increase total training time.
Evaluating perplexity in every iteration might increase training time
up to two-fold.</p>
</div></blockquote>
<p><strong>perp_tol</strong> : float, optional (default=1e-1)</p>
<blockquote>
<div><p>Perplexity tolerance in batch learning. Only used when
<code class="docutils literal notranslate"><span class="pre">evaluate_every</span></code> is greater than 0.</p>
</div></blockquote>
<p><strong>mean_change_tol</strong> : float, optional (default=1e-3)</p>
<blockquote>
<div><p>Stopping tolerance for updating document topic distribution in E-step.</p>
</div></blockquote>
<p><strong>max_doc_update_iter</strong> : int, optional (default=100)</p>
<blockquote>
<div><p>Max number of iterations for updating document topic distribution in
the E-step.</p>
</div></blockquote>
<p><strong>check_doc_likelihood</strong> : boolean, optional (default=False)</p>
<blockquote>
<div><p>Make sure doc log likelihood is increasing during e-step.
Warnings will be printed if likelihood decreases. Also, this will
significantly increase the training time.</p>
</div></blockquote>
<p><strong>n_jobs</strong> : int, optional (default=1)</p>
<blockquote>
<div><p>The number of jobs to use in the E-step. If -1, all CPUs are used. For
<code class="docutils literal notranslate"><span class="pre">n_jobs</span></code> below -1, (n_cpus + 1 + n_jobs) are used. Only used in
batch learning now since it might not help when you do online learning
with small batch size.</p>
</div></blockquote>
<p><strong>verbose</strong> : int, optional (default=0)</p>
<blockquote>
<div><p>Verbosity level.</p>
</div></blockquote>
<p><strong>random_state</strong> : int or RandomState instance or None, optional (default=None)</p>
<blockquote class="last">
<div><p>Pseudo-random number generator seed control.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<dl class="docutils">
<dt>[1] “Stochastic Variational Inference”, Matthew D. Hoffman, David M. Blei,</dt>
<dd>Chong Wang, John Paisley, 2013</dd>
<dt>[2] “Online Variational Inference for the Hierarchical Dirichlet Process”,</dt>
<dd>Chong Wang, John Paisley, David M. Blei, 2011</dd>
<dt>[3] Chong Wang’s online-hdp code. Link:</dt>
<dd><a class="reference external" href="https://github.com/blei-lab/online-hdp">https://github.com/blei-lab/online-hdp</a></dd>
</dl>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="35%" />
<col width="65%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>lambda_: array, [n_topic_truncate, n_features]</strong></td>
<td>Golbal Variational parameter for topic word distribution (<cite>beta</cite>) q(beta) ~ Direchlet(lambda)</td>
</tr>
<tr class="row-even"><td><strong>v_stick_: array, [2, n_topic_truncate-1]</strong></td>
<td>Golbal Variational parameter for topic stick length (<cite>v</cite>) q(v_k) ~ Beta(a_[0, k], a_1[1, k])</td>
</tr>
<tr class="row-odd"><td><strong>n_mini_batch_iter_</strong></td>
<td>(int) Number of iterations of the mini-batch EM step.</td>
</tr>
<tr class="row-even"><td><strong>n_iter_</strong></td>
<td>(int) Number of passes over the dataset.</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="bnp.online_hdp.HierarchicalDirichletProcess.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>X</em>, <em>y=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bnp/online_hdp.html#HierarchicalDirichletProcess.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bnp.online_hdp.HierarchicalDirichletProcess.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Learn model for the data X</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>X</strong> : array-like or sparse matrix, shape=(n_samples, n_features)</p>
<blockquote>
<div><p>Document word matrix.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">self</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="bnp.online_hdp.HierarchicalDirichletProcess.partial_fit">
<code class="descname">partial_fit</code><span class="sig-paren">(</span><em>X</em>, <em>y=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bnp/online_hdp.html#HierarchicalDirichletProcess.partial_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bnp.online_hdp.HierarchicalDirichletProcess.partial_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Online VB with Mini-Batch update.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>X</strong> : array-like or sparse matrix, shape=(n_samples, n_features)</p>
<blockquote>
<div><p>Document word matrix.</p>
</div></blockquote>
<p><strong>Returns</strong></p>
<p><strong>——-</strong></p>
<p class="last"><strong>self</strong></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="bnp.online_hdp.HierarchicalDirichletProcess.score">
<code class="descname">score</code><span class="sig-paren">(</span><em>X</em>, <em>y=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bnp/online_hdp.html#HierarchicalDirichletProcess.score"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bnp.online_hdp.HierarchicalDirichletProcess.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate approximate log-likelihood as score.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>X</strong> : array-like or sparse matrix, shape=(n_samples, n_features)</p>
<blockquote>
<div><p>Document word matrix.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>score</strong> : float</p>
<blockquote class="last">
<div><p>Use approximate bound as score.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="bnp.online_hdp.HierarchicalDirichletProcess.topic_distribution">
<code class="descname">topic_distribution</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bnp/online_hdp.html#HierarchicalDirichletProcess.topic_distribution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bnp.online_hdp.HierarchicalDirichletProcess.topic_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Topic distribution from stick-break process</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>topic_distr</strong> : shape=(n_topics,)</p>
<blockquote class="last">
<div><p>topic distribution from stick-breaking process. (sum to 1.)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="bnp.online_hdp.HierarchicalDirichletProcess.transform">
<code class="descname">transform</code><span class="sig-paren">(</span><em>X</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bnp/online_hdp.html#HierarchicalDirichletProcess.transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#bnp.online_hdp.HierarchicalDirichletProcess.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform data X according to the fitted model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>X</strong> : array-like or sparse matrix, shape=(n_samples, n_features)</p>
<blockquote>
<div><p>Document word matrix.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>doc_topic_distr</strong> : shape=(n_samples, n_topics)</p>
<blockquote class="last">
<div><p>Unnormalized document topic distribution for X.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Vighnesh Birodkar.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>